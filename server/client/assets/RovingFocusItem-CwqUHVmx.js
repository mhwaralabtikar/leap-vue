var F=t=>{throw TypeError(t)};var Y=(t,n,o)=>n.has(t)||F("Cannot "+o);var w=(t,n,o)=>(Y(t,n,"read from private field"),o?o.call(t):n.get(t)),O=(t,n,o)=>n.has(t)?F("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(t):n.set(t,o);import{i as J}from"./nullish-CHIgUVhi.js";import{d as H,c as Z,a as Q}from"./useForwardExpose-DjYziLYl.js";import{r as g,h as A,an as W,d as S,ag as X,aq as ee,a9 as R,w as te,ap as re,M as ne,A as N,f as D,l as T,j as K,k as m,N as P,o as oe,Z as ae,ad as ie}from"./entry-server-DIdk1VNC.js";import{S as z,P as _}from"./index-BmMS0d8z.js";import{i as se,u as le}from"./useForwardPropsEmits-BeYNsp5-.js";function j(t){return typeof t=="string"?`'${t}'`:new ue().serialize(t)}const ue=function(){var n;class t{constructor(){O(this,n,new Map)}compare(e,r){const a=typeof e,u=typeof r;return a==="string"&&u==="string"?e.localeCompare(r):a==="number"&&u==="number"?e-r:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(r,!0))}serialize(e,r){if(e===null)return"null";switch(typeof e){case"string":return r?e:`'${e}'`;case"bigint":return`${e}n`;case"object":return this.$object(e);case"function":return this.$function(e)}return String(e)}serializeObject(e){const r=Object.prototype.toString.call(e);if(r!=="[object Object]")return this.serializeBuiltInType(r.length<10?`unknown:${r}`:r.slice(8,-1),e);const a=e.constructor,u=a===Object||a===void 0?"":a.name;if(u!==""&&globalThis[u]===a)return this.serializeBuiltInType(u,e);if(typeof e.toJSON=="function"){const c=e.toJSON();return u+(c!==null&&typeof c=="object"?this.$object(c):`(${this.serialize(c)})`)}return this.serializeObjectEntries(u,Object.entries(e))}serializeBuiltInType(e,r){const a=this["$"+e];if(a)return a.call(this,r);if(typeof(r==null?void 0:r.entries)=="function")return this.serializeObjectEntries(e,r.entries());throw new Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,r){const a=Array.from(r).sort((c,d)=>this.compare(c[0],d[0]));let u=`${e}{`;for(let c=0;c<a.length;c++){const[d,i]=a[c];u+=`${this.serialize(d,!0)}:${this.serialize(i)}`,c<a.length-1&&(u+=",")}return u+"}"}$object(e){let r=w(this,n).get(e);return r===void 0&&(w(this,n).set(e,`#${w(this,n).size}`),r=this.serializeObject(e),w(this,n).set(e,r)),r}$function(e){const r=Function.prototype.toString.call(e);return r.slice(-15)==="[native code] }"?`${e.name||""}()[native]`:`${e.name}(${e.length})${r.replace(/\s*\n\s*/g,"")}`}$Array(e){let r="[";for(let a=0;a<e.length;a++)r+=this.serialize(e[a]),a<e.length-1&&(r+=",");return r+"]"}$Date(e){try{return`Date(${e.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(",")}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((r,a)=>this.compare(r,a)))}`}$Map(e){return this.serializeObjectEntries("Map",e.entries())}}n=new WeakMap;for(const o of["Error","RegExp","URL"])t.prototype["$"+o]=function(e){return`${o}(${e})`};for(const o of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])t.prototype["$"+o]=function(e){return`${o}[${e.join(",")}]`};for(const o of["BigInt64Array","BigUint64Array"])t.prototype["$"+o]=function(e){return`${o}[${e.join("n,")}${e.length>0?"n":""}]`};return t}();function M(t,n){return t===n||j(t)===j(n)}function Se(t,n){return J(t)?!1:Array.isArray(t)?t.some(o=>M(o,n)):M(t,n)}function ce(t){const n=se({dir:g("ltr")});return A(()=>{var o;return(t==null?void 0:t.value)||((o=n.dir)==null?void 0:o.value)||"ltr"})}function x(){let t=document.activeElement;if(t==null)return null;for(;t!=null&&t.shadowRoot!=null&&t.shadowRoot.activeElement!=null;)t=t.shadowRoot.activeElement;return t}function B(){const t=g(),n=A(()=>{var o,e;return["#text","#comment"].includes((o=t.value)==null?void 0:o.$el.nodeName)?(e=t.value)==null?void 0:e.$el.nextElementSibling:H(t)});return{primitiveElement:t,currentElement:n}}const U="data-reka-collection-item";function k(t={}){const{key:n="",isProvider:o=!1}=t,e=`${n}CollectionProvider`;let r;if(o){const l=g(new Map);r={collectionRef:g(),itemMap:l},re(e,r)}else r=W(e);const a=(l=!1)=>{const s=r.collectionRef.value;if(!s)return[];const f=Array.from(s.querySelectorAll(`[${U}]`)),y=Array.from(r.itemMap.value.values()).sort((h,I)=>f.indexOf(h.ref)-f.indexOf(I.ref));return l?y:y.filter(h=>h.ref.dataset.disabled!=="")},u=S({name:"CollectionSlot",setup(l,{slots:s}){const{primitiveElement:f,currentElement:v}=B();return te(v,()=>{r.collectionRef.value=v.value}),()=>R(z,{ref:f},s)}}),c=S({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(l,{slots:s,attrs:f}){const{primitiveElement:v,currentElement:y}=B();return X(h=>{if(y.value){const I=ee(y.value);r.itemMap.value.set(I,{ref:y.value,value:l.value}),h(()=>r.itemMap.value.delete(I))}}),()=>R(z,{...f,[U]:"",ref:v},s)}}),d=A(()=>Array.from(r.itemMap.value.values())),i=A(()=>r.itemMap.value.size);return{getItems:a,reactiveItems:d,itemMapSize:i,CollectionSlot:u,CollectionItem:c}}const fe="rovingFocusGroup.onEntryFocus",de={bubbles:!1,cancelable:!0},pe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function me(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function ve(t,n,o){const e=me(t.key,o);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(e))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(e)))return pe[e]}function L(t,n=!1){const o=x();for(const e of t)if(e===o||(e.focus({preventScroll:n}),x()!==o))return}function ye(t,n){return t.map((o,e)=>t[(n+e)%t.length])}const[he,be]=Z("RovingFocusGroup"),Te=S({__name:"RovingFocusGroup",props:{orientation:{default:void 0},dir:{},loop:{type:Boolean,default:!1},currentTabStopId:{},defaultCurrentTabStopId:{},preventScrollOnEntryFocus:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["entryFocus","update:currentTabStopId"],setup(t,{expose:n,emit:o}){const e=t,r=o,{loop:a,orientation:u,dir:c}=ne(e),d=ce(c),i=Q(e,"currentTabStopId",r,{defaultValue:e.defaultCurrentTabStopId,passive:e.currentTabStopId===void 0}),l=g(!1),s=g(!1),f=g(0),{getItems:v,CollectionSlot:y}=k({isProvider:!0});function h(p){const $=!s.value;if(p.currentTarget&&p.target===p.currentTarget&&$&&!l.value){const E=new CustomEvent(fe,de);if(p.currentTarget.dispatchEvent(E),r("entryFocus",E),!E.defaultPrevented){const C=v().map(b=>b.ref).filter(b=>b.dataset.disabled!==""),V=C.find(b=>b.getAttribute("data-active")===""),G=C.find(b=>b.id===i.value),q=[V,G,...C].filter(Boolean);L(q,e.preventScrollOnEntryFocus)}}s.value=!1}function I(){setTimeout(()=>{s.value=!1},1)}return n({getItems:v}),be({loop:a,dir:d,orientation:u,currentTabStopId:i,onItemFocus:p=>{i.value=p},onItemShiftTab:()=>{l.value=!0},onFocusableItemAdd:()=>{f.value++},onFocusableItemRemove:()=>{f.value--}}),(p,$)=>(D(),N(m(y),null,{default:T(()=>[K(m(_),{tabindex:l.value||f.value===0?-1:0,"data-orientation":m(u),as:p.as,"as-child":p.asChild,dir:m(d),style:{outline:"none"},onMousedown:$[0]||($[0]=E=>s.value=!0),onMouseup:I,onFocus:h,onBlur:$[1]||($[1]=E=>l.value=!1)},{default:T(()=>[P(p.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),Ce=S({__name:"RovingFocusItem",props:{tabStopId:{},focusable:{type:Boolean,default:!0},active:{type:Boolean},allowShiftKey:{type:Boolean},asChild:{type:Boolean},as:{default:"span"}},setup(t){const n=t,o=he(),e=le(),r=A(()=>n.tabStopId||e),a=A(()=>o.currentTabStopId.value===r.value),{getItems:u,CollectionItem:c}=k();oe(()=>{n.focusable&&o.onFocusableItemAdd()}),ae(()=>{n.focusable&&o.onFocusableItemRemove()});function d(i){if(i.key==="Tab"&&i.shiftKey){o.onItemShiftTab();return}if(i.target!==i.currentTarget)return;const l=ve(i,o.orientation.value,o.dir.value);if(l!==void 0){if(i.metaKey||i.ctrlKey||i.altKey||!n.allowShiftKey&&i.shiftKey)return;i.preventDefault();let s=[...u().map(f=>f.ref).filter(f=>f.dataset.disabled!=="")];if(l==="last")s.reverse();else if(l==="prev"||l==="next"){l==="prev"&&s.reverse();const f=s.indexOf(i.currentTarget);s=o.loop.value?ye(s,f+1):s.slice(f+1)}ie(()=>L(s))}}return(i,l)=>(D(),N(m(c),null,{default:T(()=>[K(m(_),{tabindex:a.value?0:-1,"data-orientation":m(o).orientation.value,"data-active":i.active?"":void 0,"data-disabled":i.focusable?void 0:"",as:i.as,"as-child":i.asChild,onMousedown:l[0]||(l[0]=s=>{i.focusable?m(o).onItemFocus(r.value):s.preventDefault()}),onFocus:l[1]||(l[1]=s=>m(o).onItemFocus(r.value)),onKeydown:d},{default:T(()=>[P(i.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}});export{Te as _,Ce as a,Se as b,B as c,x as g,M as i,ce as u};
